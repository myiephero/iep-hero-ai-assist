#!/bin/bash

# npm wrapper script for deployment
echo "🔧 npm wrapper called with: $*"

# Handle "npm run build" command from .replit deployment  
if [[ "$*" == *"run build"* ]]; then
  echo "📦 Redirecting to working build system..."
  
  # Set proper PATH
  export PATH="/nix/store/hdq16s6vq9smhmcyl4ipmwfp9f2558rc-nodejs-20.10.0/bin:$PATH"
  
  # Run our working build script
  /nix/store/hdq16s6vq9smhmcyl4ipmwfp9f2558rc-nodejs-20.10.0/bin/node build
  
  if [ $? -eq 0 ]; then
    echo "✅ Build completed via wrapper"
    exit 0
  else
    echo "❌ Build failed"
    exit 1
  fi
fi

# Handle other commands
echo "ℹ️ npm wrapper: ignoring command"
exit 0